---
title: データソースからコンテンツスニペットを挿入する
description: AEM Guides でデータソースのデータを使用する。 データソースからコンテンツスニペットを挿入する方法を説明します。 トピックジェネレーターを使用してトピックを作成します。
exl-id: fbd5eff2-451b-49d6-ba77-6eb271e94349
feature: Authoring, Features of Web Editor
role: User
source-git-commit: 2e5bf87b65cca6b522fcb97db1f40f98f020927a
workflow-type: tm+mt
source-wordcount: '2389'
ht-degree: 0%

---

# データソースからのデータの使用

A **データソース** は、組織のデータを保存および管理するシステムです。 これらは、JIRA、SQL データベース、PIM、PLM などのレコードシステムです。 AEM ガイドには、データソースに接続してデータソースのデータを使用する機能が用意されています。

また、ファイルコネクタを使用して JSON データファイルに接続することもできます。 コンピューターから JSON ファイルをアップロードするか、Adobe Experience Manager Assets から参照します。 次に、ジェネレーターを使用してコンテンツスニペットまたはトピックを作成します。

## データソースパネル

を選択 **データソース** ![データソース](images/data-source-icon.svg) 左側のパネルに接続されたデータソースが表示されます。 データソースパネルが開き、接続されているすべてのデータソースが表示されます。

管理者は、設定に基づいて、データソースコネクタを設定できます。

<details>
<summary> Cloud Services </summary>


- 2023 年 10 月リリース以降を使用している場合は、次の方法を参照してください。 [ユーザーインターフェイスからのデータソースコネクタの設定](../cs-install-guide/conf-data-source-connector-tools.md) （Cloud Serviceのインストールおよび設定ガイド）を参照してください。

- 2023 年 7 月リリースまたは 2023 年 9 月リリースを使用している場合は、次の方法を参照してください [データソースコネクタの設定](../cs-install-guide/conf-data-source-connector.md) （Cloud Serviceのインストールおよび設定ガイド）を参照してください。

</details>

<details>    
<summary>  オンプレミスソフトウェア </summary>

- 4.3.1 リリース以降を使用している場合は、次の方法を参照してください [ユーザーインターフェイスからのデータソースコネクタの設定](../cs-install-guide/conf-data-source-connector-tools.md) （オンプレミスのインストールおよび設定ガイド）を参照してください。

- 4.3 リリースを使用している場合は、次の方法を参照してください [データソースコネクタの設定](../cs-install-guide/conf-data-source-connector.md) （オンプレミスのインストールおよび設定ガイド）を参照してください。
</details>


>[!NOTE]
>
> 管理者がコネクタを設定したデータソースが表示されます。


## リスト表示またはタイル表示を表示

様々なデータソースをリスト形式またはタイル形式で表示するには、リスト表示とタイル表示を切り替えることができます。

データソースを選択して、選択したデータソースで使用可能なコンテンツスニペットジェネレーターとトピックジェネレーターを表示します。

### リスト表示  ![](images/data-sources-list-view-icon.svg)

![](images/data-sources-list-view.png){width="300" align="left"}

*接続されているデータソースのリスト。*

### タイル表示   ![](images/data-sources-tile-view-icon.svg)

![](images/data-sources-tile-view.png){width="300" align="left"}

*接続されたデータソースをタイルで表示します。*

データソースのデータは、次の 2 つの方法で使用できます。
- コンテンツスニペットの挿入
- トピックの作成



## データソースからコンテンツスニペットを挿入する

AEM ガイドには、データソースに接続するための機能が用意されています。 データを取得し、トピックに挿入して編集できます。 コンテンツスニペットジェネレーターを使用してコンテンツスニペットを簡単に作成し、トピック内で再利用できます。

コンテンツスニペットジェネレーターを使用してコンテンツスニペットを作成し、トピックに挿入するには、次の手順を実行します。

1. を選択 **データソース** ![](images/data-source-icon.svg)   左側のパネルに接続されたデータソースが表示されます。

1. データソースを選択し、選択したデータソースで使用可能なコンテンツスニペットジェネレーターを表示します。

   ![](images/code-snippet-generator.png){width="300" align="left"}

   *データソースパネルには、使用可能なコンテンツスニペットジェネレーターのリストが表示されます。*

1. を選択 **追加** 新しいコンテンツスニペットジェネレーターを追加します。 この **コンテンツスニペットジェネレーターを追加** パネルが開きます。

1. にクエリを入力 **データクエリ** テキストボックス。  を選択 **サンプルクエリをコピー** データクエリを迅速にコピーする。 クエリを手動で作成する代わりに、サンプルクエリをコピーしてに貼り付けることができます **データクエリ** テキストボックス。 次に、データ要件に従ってクエリを編集するだけです。

   >[!NOTE]
   >
   >Experience Managerには、様々なデータソース内のすべてのリソースに対する様々なサンプルクエリが用意されています。 これらは、データの取得元のデータソースにマッピングされます。

1. ファイルコネクタを使用している場合は、コンピューターから JSON ファイルをアップロードするか、Adobe Experience Manager Assets から JSON ファイルを参照できます。

   >[!NOTE]
   >
   > ファイルコネクタを使用する場合は、データクエリの代わりにファイルをアップロードまたは参照するためのオプションを表示します。

1. から、データソースにマッピングするテンプレートを選択します。 **データマッピングテンプレート** ドロップダウン。
選択したデータソースに対する標準のテンプレートがドロップダウンに表示されます。 例えば、「PostgreSQL」データソースという名前のデータソースの「sql-table」テンプレートを表示できます。

   >[!NOTE]
   >  
   > 管理者がカスタマイズしたテンプレートを設定している場合は、（管理者が行ったテンプレートパス設定に基づいて）それらのテンプレートもドロップダウンリストに表示されます。
   >   
   >テンプレートで Velocity ツールを使用することもできます。 の方法の詳細情報 [velocity ツールの使用](#use-velocity-tools).

1. この **Resource** rest Client、Salsify、Akeneo、Microsoft ADO などの一部のコネクタに対してドロップダウンが表示される。  ドロップダウンから任意のリソースを選択し、そのリソースに接続して、ジェネレーターを使用してコンテンツスニペットまたはトピックを作成します。

   >[!NOTE]
   >
   > 管理者は、データソースコネクタの設定時に、デフォルトのリソースを設定したり、複数の URL にリソースを追加したりできます。

1. クリック **取得** データソースからデータを取得し、SQL クエリによって生成されたデータにテンプレートを適用します。

1. データは、プレビューまたは DITA ソースビューで表示できます。

   1. プレビューには、コンテンツに挿入した際のデータの表示方法が表示されます。 プレビューには、選択したテンプレートの形式でデータのごく一部が表示されます。
次に例を示します。
      - SQL テーブル テンプレートを選択した場合は、SQL データを表形式で表示できます。
      - Jira 順序付きリストテンプレートを選択した場合は、Jira の課題の順序付きリストを表示できます。

   1. ソースビューには、DITA ソースビューのデータが表示されます。
      ![](images/add-content-snippet-generator.png){width="800" align="left"}
      *コンテンツスニペットジェネレーターを追加します。 データをソースモードまたはプレビューモードで表示します。*

1. クエリーの結果を保存するには、ジェネレータの名前を入力し、 **追加**.   新しいコンテンツスニペットジェネレーターがリストに追加されます。

   >[!NOTE]
   >
   > 新しいコンテンツジェネレーターの名前は、ファイル命名規則に従う必要があります。 コンテンツスニペットジェネレーターの名前にスペースを含めることはできません。 また、既存のコンテンツ ジェネレータの名前で新しいコンテンツ ジェネレータを保存することはできません。 エラーが発生しました。

### コンテンツスニペットジェネレーターのオプション

コンテンツスニペットジェネレーターを右クリックして、オプションを開きます。 オプションを使用すると、次の操作を実行できます。

- **プレビュー**：このオプションを使用してパネルを開き、出力でのデータの表示方法のごく一部を表示します。
- **挿入**：選択したコンテンツスニペットを、web エディターで編集用に開いたトピックに挿入する場合は、このオプションを使用します。 データはスニペットとして挿入されるので、トピック内のデータを Web エディターで編集することもできます。

  >[!NOTE]
  > 
  > 「挿入」オプションは、トピックの編集中にのみ表示されます。

- **編集**：コンテンツスニペットジェネレーターで変更を加えて保存するには、このオプションを使用します。
- **削除**：選択したコンテンツスニペットジェネレーターを削除するには、このオプションを使用します。
- **複製**：選択したコンテンツスニペットジェネレーターの複製またはコピーを作成するには、このオプションを使用します。 複製はデフォルトで接尾辞（generator_1 など）で作成されます。

### クエリスニペットの挿入

を使用することもできます **クエリ スニペットの挿入** ![](images/data-source-icon.svg)   をクリックして、データスニペットをトピックに挿入します。  ドロップダウンからジェネレーターを選択したり、クエリを編集したり、テンプレートを変更してトピックにデータを挿入したりできます。

![](images/insert-content-snippet.png){width="800" align="left"}

*データスニペットを編集して挿入する。*

## トピックジェネレーターを使用したトピックの作成

トピックジェネレーターは、ソースからのデータを含んだトピックを作成するのに役立ちます。 トピック ジェネレータを簡単に作成し、ジェネレータを使用してトピックを生成できます。 各トピックには、テーブル、リスト、段落など、様々な形式のデータを含めることができます。   例えば、トピックでは、すべての新製品の詳細と、販売を中止するすべての製品のリストを含むテーブルを追加できます。

トピックジェネレータは、すべてのトピックに対して、データと DITA マップを含むトピックを作成できます。 また、次のこともできます `<conref>` コンテンツ内のこれらのトピックです。 これにより、データとデータソースの同期を維持し、簡単に更新できます。





### トピックの作成

トピックジェネレーターを使用してトピックを作成するには、次の手順を実行します。

1. データソースを選択して、選択したデータソースで使用可能なコンテンツスニペットジェネレーターとトピックジェネレーターを表示します。

   ![](images/data-sources.png){width="300" align="left"}

   *接続されたデータ ソースのトピック ジェネレータを追加します。*

1. を選択 **追加** ![](images/Add_icon.svg) を選択して、 **トピック ジェネレータ** ドロップダウンから新しいトピックジェネレーターを追加します。 この **トピック ジェネレータの追加** パネルが開きます。



1. の次の 3 つのタブにあるフィールドに値を入力します。 **トピック ジェネレータの追加** パネル：

   **設定を取得**

   ![](images/topic-generator-fetch-configuration.png){width="300" align="left"}

   *トピックジェネレーターのデータクエリ、データマッピングテンプレート、ルートノードの詳細を追加し、「設定を取得」パネルで一意の名前を付けます。*

   1. にクエリを入力 **データクエリ** テキストボックス。 を選択 **サンプルクエリをコピー** データクエリを迅速にコピーする。 クエリを手動で作成する代わりに、サンプルクエリをコピーしてに貼り付けることができます **データクエリ** テキストボックス。 次に、データ要件に従ってクエリを編集するだけです。

      >[!NOTE]
      >
      >Experience Managerには、様々なデータソース内のすべてのリソースに対する様々なサンプルクエリが用意されています。 これらは、データの取得元のデータソースにマッピングされます。

   1. ファイルコネクタを使用している場合は、コンピューターから JSON ファイルをアップロードするか、Adobe Experience Manager Assets から JSON ファイルを参照できます。

      >[!NOTE]
      >
      > ファイルコネクタを使用する場合は、データクエリの代わりにファイルをアップロードまたは参照するためのオプションを表示します。

   1. から、データソースにマッピングするテンプレートを選択します。 **データマッピングテンプレート** ドロップダウン。

      >[!NOTE]
      >
      > 管理者がカスタマイズしたテンプレートを設定している場合は、（管理者が行ったテンプレートパス設定に基づいて）それらのテンプレートもドロップダウンリストに表示されます。 たとえば、順序付きリスト、表、段落、またはその他の DITA エレメントを含むトピックテンプレートを作成できます。

   1. を入力 **ルートノード**. これは、データにアクセスするノードです。 次に、トピック ジェネレータは、ルート ノードで定義されたレベルに各トピックを作成します。 例えば、Jira のルートノードとして「issues」を追加できます。 したがって、クエリによって 13 件の問題が返された場合は、各問題に対して 1 つのトピックの 13 のトピックが返されます。

   1. クリック **取得** データソースからデータを取得し、SQL クエリによって生成されたデータにテンプレートを適用します。 プレビューには、選択したテンプレートの形式でトピックが表示されるほんの一部が表示されます。 例えば、1 つの Jira の課題を、クエリから生成されたすべてのフィールドと共に表示できます。
   1. トピック ジェネレータの名前を入力します。

      >[!NOTE]
      > 
      > 新しいトピックジェネレータの名前は、ファイル命名規則に従う必要があります。 トピック ジェネレータの名前にスペースを含めることはできません。 また、既存のトピック ジェネレータの名前で新しいトピック ジェネレータを保存することはできません。 エラーが発生しました。

   **出力設定**

   ![](images/topic-generator-output-configuration.png){width="300" align="left"}

   *出力設定パネルに、出力パスとトピック命名規則の詳細を入力します。 DITA マップを生成し、名前を付けます。*

   1. を入力 **出力パス** トピックを保存する場所の詳細。
   1. が含まれる **トピックの命名規則**&#x200B;を選択します。velocity タグを使用して、値または変数を入力できます。 新しいトピックは命名規則に従います。 例えば、 `$key` jira キーに基づいてトピックを作成するには、次の手順を実行します。
   1. オプションを有効にする **マップを生成** 生成されたすべてのトピックを含むマップを作成する場合。
   1. 新しい DITA マップの名前を入力します。

   >[!NOTE]
   >
   > トピックジェネレータは、トピックと同じ出力パス上に DITA マップを生成します。

   **メタデータ**

   ドロップダウンから、トピックに渡すメタデータプロパティを選択します。 **名前** カスタムプロパティとデフォルトプロパティの両方がドロップダウンリストに表示されます。

   例えば、次のスクリーンショットでは、 `dc:description`, `dc:language`, `dc:title`、および `docstate` は、値を定義できるデフォルトのプロパティです。 author などのカスタムプロパティを作成し、その値を定義できます。

   ![](images/topic-generator-metadata.png){width="300" align="left"}

   *トピックに渡すメタデータプロパティをメタデータパネルに追加します。*

1. ジェネレータの名前を入力して、 **保存** クエリ結果を保存します。 新しいトピック ジェネレータがリストに追加されます。

1. クリック **保存して生成** トピック ジェネレータを保存し、トピック ジェネレータから新しいトピックを生成します。



   ![](images/edit-topic-generator.png){width="650" align="left"}

   *既存のトピック ジェネレータから新しいトピックを生成します。*

   >[!NOTE]
   >
   > トピックが既に存在する場合、ジェネレータは既存のトピック内のデータを更新します。

### トピックジェネレーターのオプション

トピック ジェネレータを右クリックして、 **オプション**. オプションを使用すると、次の操作を実行できます。

- **Generate**：このオプションは、選択したトピックジェネレーターのトピックを生成します。 また、このオプションを使用して、既存のトピックを更新することもできます。 データソースに接続し、更新されたデータを取得します。 コンテンツの生成中、このオプションは無効になり、ローダーが表示されます。
  >[!NOTE]
  >
  >トピックが既に存在する場合は、トピック内のデータを上書きするか、新しいバージョンとして保存できます。

  ![](images/generate-topic-options.png)

  *トピックを生成し、ファイルが既に存在する場合は、新しいバージョンとして保存するか、上書きします。*
- **ログを表示**：コンテンツ生成ログファイルを表示する場合は、このオプションを選択します。 ログファイルが新しいタブで開きます。 エラー、警告、情報メッセージおよび例外は、ログ・ファイルで確認できます。 このオプションは、選択したトピック ジェネレータのコンテンツを生成した場合に有効になります。

- **プレビュー**：このオプションを使用してパネルを開き、出力でのデータの表示方法のごく一部を表示します。



- **編集**：トピックジェネレーターを変更して保存するには、このオプションを使用します。 このオプションは、コンテンツの生成中は無効になっています。
- **削除**：選択したトピックジェネレーターを削除するには、このオプションを使用します。 このオプションは、コンテンツの生成中は無効になっています。
- **複製**：選択したトピックジェネレーターの複製またはコピーを作成します。 複製はサフィックスで作成されます（ `topic-sample_1`）がデフォルトで選択されています。



## データソーステンプレートでの Velocity ツールの使用 {#use-velocity-tools}

Experience Managerテンプレートは Velocity ツール（バージョン 2.0）もサポートしています。 これらのツールを使用すると、データソースから取得したデータに様々な機能を適用できます。 の使用についての詳細 [Velocity ツール](https://velocity.apache.org/tools/2.0/generic.html) および適用できる関数です。

テンプレートで速度ツールを使用するには、次の手順を実行します。
1. Web エディターで Velocity テンプレートを編集します。
1. にツールとその機能を追加する `<tool.function>` 形式。 次に例を示します。
   - 計算ツールを使用して乱数を生成するには、次を使用します `$mathTool.random`.
   - 数学ツールを使用して数値の合計を生成するには、次を使用します `$mathTool.add(num1, num2)`.
1. テンプレートを使用して、コンテンツスニペットまたはトピックを作成します。
1. テンプレートをデータに適用した後、プレビューまたは DITA ソースビューでデータを表示できます。




Velocity テンプレート内で次のツールを使用して、コネクタから取得するデータに様々な関数を適用できます。`$alternatorTool`
- `$classTool`
- `$contextTool`
- `$conversionTool`
- `$dateTool`
- `$comparisonDateTool`
- `$displayTool`
- `$escapeTool`
- `$fieldTool`
- `$loopTool`
- `$linkTool`
- `$listTool`
- `$mathTool`
- `$numberTool`
- `$renderTool`
- `$resourceTool`
- `$sortTool`
