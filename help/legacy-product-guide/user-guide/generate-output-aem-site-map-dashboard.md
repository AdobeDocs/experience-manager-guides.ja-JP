---
title: AEM サイト
description: AEM Guidesで、マップ ダッシュボードからAEM Sites プリセットを作成して設定します。 AEM Sites サポートを使用して、記事ベースの出力を生成したり、リンクされたトピックや conref を公開したり、コンテンツ内の文字列を検索したりします。
feature: Publishing
role: User
source-git-commit: fa07db6a9cb8d8f5b133258acd5647631b22e28a
workflow-type: tm+mt
source-wordcount: '2404'
ht-degree: 0%

---

# マップダッシュボードのAEM Sites プリセット {#id205BE3008SW}

マップダッシュボードからAEM Sites プリセットを作成し、それらをAEM Sites出力を生成するように設定することができます。


AEM Sites出力には、次のオプションを使用できます。

| AEM Sitesオプション | 説明 |
| --- | --- |
| 出力タイプ | 生成する出力のタイプ。 レスポンシブなAEM Sites出力を生成するには、「AEM Sites」オプションを選択します。 |
| 設定名 | 作成するAEM Sites設定にわかりやすい名前を付けます。 例えば、*内部顧客出力* または *エンドユーザー出力* を指定できます。 |
| サイト名 | 出力がAEM リポジトリに保存されるサイト名。<br><br>AEM リポジトリ内のノードは、ここで指定した名前で作成されます。 サイト名を指定しない場合は、DITA マップファイル名を使用してサイトノードが作成されます。<br><br> ここで指定するサイト名は、ブラウザータブのタイトルとしても使用されます。<br><br> サイト名を設定する際に変数を使用することもできます。 変数の使用について詳しくは、[ 宛先パス、サイト名、ファイル名のオプションを設定するための変数の使用 ](generate-output-use-variables.md#id18BUG70K05Z) を参照してください。 |
| デザイン | 出力の生成に使用するデザインテンプレートを選択します。<br><br> カスタムデザインテンプレートを使用して出力を生成する方法について詳しくは、公開管理者にお問い合わせください。 |
| 宛先のパス | 出力が保存されるAEM リポジトリ内のパス。 最終出力の生成時に、サイト名と出力先パスが結合されます。 例えば、サイト名を `user-guide` に、デスティネーション パスを `/content/output/aem-guides` に指定した場合、最終的な出力は `/content/output/aem-guides/user-guide` ノードの下に生成されます。<br><br> 宛先パスの設定時に変数を使用することもできます。 変数の使用について詳しくは、[ 宛先パス、サイト名、ファイル名のオプションを設定するための変数の使用 ](generate-output-use-variables.md#id18BUG70K05Z) を参照してください。 |
| 次を使用して条件を適用 | 次のいずれかのオプションを選択します。<br><br>**適用なし**：公開済みの出力に条件を適用しない場合は、このオプションを選択します。<br>**DITAVal ファイル**：条件付きコンテンツを生成する DITAVal ファイルを選択します。 参照ダイアログを使用するか、ファイルパスを入力して、複数の DITAVal ファイルを選択できます。 削除するには、ファイル名の近くにある十字のアイコンを使用します。 DITAVal ファイルは指定された順序で評価されるため、最初のファイルで指定された条件は、後のファイルで指定された一致条件よりも優先されます。 ファイルを追加または削除することで、ファイルの順序を維持できます。 DITAVal ファイルが他の場所に移動された場合や削除された場合は、マップ ダッシュボードから自動的には削除されません。 ファイルが移動または削除された場合は、場所を更新する必要があります。 ファイル名の上にマウスポインターを置くと、AEM リポジトリ内でファイルが格納されているパスが表示されます。 DITAVal ファイルのみを選択できます。他のファイル タイプを選択すると、エラーが表示されます。<br>**条件プリセット**：出力の公開中に条件を適用する条件プリセットをドロップダウンから選択します。 このオプションは、DITA マップファイルに条件を追加した場合に表示されます。 条件付き設定は、DITA マップコンソールの「条件プリセット」タブで使用できます。 条件プリセットについて詳しくは、「[ 条件プリセットの使用 ](generate-output-use-condition-presets.md#id1825FL004PN)」を参照してください。 |
| 既存の出力ページ | 既存のページのコンテンツを上書きするには、「**コンテンツを上書き**」オプションを選択します。 このオプションで上書きされるのは、ページのコンテンツノードとヘッドノードの下に存在するコンテンツのみです。 このオプションを使用すると、コンテンツを混在させて公開できます。 このオプションを選択すると、公開済み出力から孤立したページの削除を選択できます。 これは、AEM Sites出力を作成するための *デフォルト* オプションでもあります。<br><br> 「**削除して作成**」オプションを選択して、公開中に既存のページを強制的に削除します。 このオプションは、ページノードとそのコンテンツ、およびその下にあるすべての子ページを削除します。 出力プリセットのデザインテンプレートを変更した場合や、宛先に既に存在する追加のページを削除したい場合は、このオプションを使用します。 |
| 孤立したサイト ページの削除 | **既存の出力ページ** 設定で **コンテンツを上書き** を選択すると、このオプションが表示されます。 このオプションを選択すると、すべての孤立ページが公開済みのAEM サイトから削除されます。 この機能を正常に実行するには、増分公開を使用せずに、DITA マップ全体を公開する必要があります。<br><br> トピック a.dita、b.dita、および c.dita を含む DITA マップをパブリッシュしたとします。 マップを再度公開する前に、マップから b.dita トピックを削除しました。 ここで、このオプションを選択した場合、b.dita に関連するすべてのコンテンツがAEM Sites出力から削除され、a.dita と c.dita のみが公開されます。<br><br> この機能では、公開された子マップは削除されません。 たとえば、親マップに子マップが含まれ、子マップ全体を削除した場合、子マップのコンテンツはパブリッシュされた出力から削除されません。 ただし、子マップからトピックを削除して再公開すると、削除されたトピックのコンテンツはサイト出力から削除されます。<br><br> また、参照されているコンテンツがあり、再公開する前にそのコンテンツが削除された場合、参照されているコンテンツのデータは削除されません。<br><br>**注意**：削除されたオーファンページに関する情報も、出力生成ログで取得されます。 ログファイルへのアクセスについて詳しくは、[ ログファイルの表示と確認 ](generate-output-basic-troubleshooting.md#id1821I0Y0G0A__id1822G0P0CHS) を参照してください。 |
| 一時ファイルを保持 | このオプションを選択すると、DITA-OT によって生成された一時ファイルが保持されます。 DITA-OT 経由で出力を生成するときにエラーが発生した場合は、このオプションを選択して一時ファイルを保持します。 その後、これらのファイルを使用して、出力生成エラーのトラブルシューティングを行うことができます。<br> <br> 出力を生成したら、「**一時ファイルをダウンロード**![ 一時ファイルをダウンロード」アイコン ](images/download-temp-files-icon.png) アイコンを選択して、一時ファイルを含む ZIP フォルダーをダウンロードします。<br><br> **メモ**：生成中にファイルプロパティが追加された場合、出力一時ファイルには、それらのプロパティを含む *metadata.xml* ファイルも含まれます。 |
| トピックごとに個別のPDFを生成 | 選択すると、DITA マップ内のすべてのトピックに対してPDFも作成されます。 このオプションを選択すると、新しい「PDFパスを分割」オプションが表示されます。<br><br> 分割PDFパス フィールドで、各トピックに対して生成されたPDFを保存するパスを指定します。<br><br>**メモ**:AEM Guidesは、pdfx という名前の DITA-OT プラグインを使用して、各トピックのPDFを生成します。 このプラグインは、初期状態で出荷された DITA-OT パッケージにバンドルされています。 必要に応じて、このプラグインをカスタマイズしてPDFを生成できます。 カスタム DITA-OT プラグインを使用する場合は、必ず pdfx プラグインを組み込んで、トピックレベルのPDF生成機能を持たせてください。 |
| 生成後ワークフローを実行 | このオプションを選択すると、新しいポスト生成ワークフローのドロップダウンリストが表示され、AEMで設定されたすべてのワークフローが表示されます。 出力生成ワークフローの完了後に実行するワークフローを選択する必要があります。 |
| ベースラインの使用 | 選択した DITA マップにベースラインを作成した場合、このオプションを選択して、公開するバージョンを指定します。<br><br>**重要**:AEM サイトの増分出力を生成する場合、出力は、添付されたベースラインではなく、現在のバージョンのファイルを使用して作成されます。<br><br> 詳しくは、「[ ベースラインの操作 ](generate-output-use-baseline-for-publishing.md#id1825FI0J0PF) を参照してください。 |
| プロパティ | メタデータとして処理するプロパティを選択します。 これらのプロパティは、DITA マップまたはブックマップファイルの「プロパティ」 ページから設定されます。 ドロップダウンリストから選択したプロパティが **ファイルプロパティ** フィールドの下に表示されます。 プロパティを削除するには、プロパティの横にある十字アイコンを選択します。 <br><br>**メモ**：メタデータプロパティでは大文字と小文字が区別されます。<br><br>*ベースラインを選択した場合、プロパティの値は選択したベースラインのバージョンに基づきます。<br>* ベースラインを選択していない場合、プロパティの値は最新バージョンに基づきます。<br><br>DITA-OT パブリッシングを使用して、出力にメタデータを渡すこともできます。 詳しくは、[DITA-OT を使用してメタデータを出力に渡す ](pass-metadata-dita-ot.md#id21BJ00QD0XA) を参照してください。<br><br>**注意**: 「プロパティ」オプションで `cq:tags` を定義していない場合、公開用に「ベースライン」を選択していても、`cq:tags` の値は現在の作業コピーから取得されます。 |
| 既定としてマップ プロパティを使用 | 選択すると、マップ ファイルに対して定義されたプロパティも、これらのプロパティが定義されていないトピックにコピーされます。 このオプションを使用する際は、次の点を考慮してください。<br><br>*文字列、日付、または長い（単一および複数の値を持つ）プロパティのみをAEM Sites ページに渡すことができます。<br>* 文字列タイプのプロパティのメタデータ値は、特殊文字（`@, #, " "` など）をサポートしていません。<br>*このオプションは、`Properties` オプションと一緒に使用する必要があります。 |

## AEM Sitesに関するその他の注意事項

### Web エディターから記事ベースの出力を生成

Web エディタから 1 つ以上のトピックまたは DITA マップ全体のAEM Sites出力を生成できます。 DITA マップの出力プリセットを作成する必要があり、その後でマップのAEM Sites出力を簡単に生成できます。 マップ内のいくつかのトピックを更新した場合は、それらのトピックに対するAEM Sites出力のみを Web エディタから生成することもできます。 詳しくは、[Web エディターからの記事ベースの公開 ](web-editor-article-publishing.md#id218CK0U019I) を参照してください。

### 他のマップからリンク トピックの出力を生成

複数のフォルダと DITA マップに文書のセットを広げることは、非常に一般的なシナリオです。 様々な場所からリンクされているコンテンツを公開することは、非常に複雑になります。 デフォルトでは、す `<xref>` てのリンクは `local` `@scope` で作成されます。 このようなトピックを公開する場合は、トピックへの直接リンクが使用されるので、課題はありません。 トピックが現在の DITA マップの外部にある場合、リンクはリンクされたコンテンツを表示しません。

コンテンツをリンクするもう 1 つの方法は、`peer` `@scope` を使用してリンクを作成することです。 このようなコンテンツの場合、リンクは実行時に DITA マップの公開コンテキストからファイルのタイトルとリンクトピックの設定済みコンテキストを選択して解決されます。 次のスクリーンショットは、`peer` の `@scope` を持つリンクのプロパティパネルを示しています。

![](images/peer-link-scope-link.png){width="800" align="left"}

他のマップ内の他のトピックにリンクする複雑なマップやトピックの公開を簡単にするために、AEM Guidesでは、各出力プリセットの公開コンテキストを設定できます。

公開コンテキストを使用すると、特定の出力を公開するマップから使用する必要があるトピックを指定できます。 例を利用してこれを理解しましょう。例えば、4 つのフォルダー（サンプル a、サンプル b、サンプル c、サンプル d）があるとします。各フォルダには DITA マップ （DITA マップ A、DITA マップ B、DITA マップ C、および DITA マップ D）が含まれています。クロスマップリンクは、DITA マップ A のトピックが DITA マップ B、C、または D のトピックにリンクするときに発生します。次のスクリーンショットでは、サンプルの概念トピックに、他の DITA マップの一部であるファイルへのリンク \（または参照\）が含まれています。

![](images/sample-concept-link-to-other.png){width="350" align="left"}

これで、このトピックを含むマップ ファイルに対してAEM Sitesの公開設定を指定する際に、リンクされたコンテンツの公開コンテキストのうち、公開時に使用するコンテキストを選択できるようになりました。 公開コンテキストは、DITA マップとその出力プリセットの組み合わせです。 出力プリセットには、コンテンツの特定のバージョンと条件付きプリセットが含まれます。 この DITA マップ、出力プリセット、\（files\） バージョン、および条件の組み合わせによって、リンクされたマップの公開コンテキストが定義されます。

クロスリンクされたファイルの公開コンテキストを指定するには、次の手順を実行します。

1. 公開する DITA マップの「**出力プリセット**」タブを開きます。

1. **AEM Site** 出力プリセットを選択します。

   「AEM プリセット設定」タブと「Publish コンテキスト」タブが表示されます。

   ![](images/aem-site-publish-settings.png){width="800" align="left"}

1. 「**Publish コンテキスト**」タブを開きます。

   依存トピックのリストが表示されます。 これらのトピックは、現在のマップの一部のトピックからリンクされていますが、他の DITA マップでも使用できます。

   >[!NOTE]
   >
   > 「Publish コンテキスト」タブには、`peer` `@scope` を使用してのみリンクされているトピックが表示されます。 `local` `@scope` を含むリンクの場合は、公開コンテキストを指定する必要はありません。

   デフォルトでは、リンクされているすべてのトピックで、最新の出力プリセットおよびマップが選択されます。

   ![](images/default-publish-context.png){width="800" align="left"}

1. DITA マップとプリセットのデフォルトの選択を変更するには、**編集**\（メインツールバーの\）をクリックします。

1. マップ内の各依存ファイルの最終公開出力を使用する場合は、「**すべての依存トピックに対して最近生成された公開コンテキストを使用**」を選択します。

1. **親マップ** ドロップダウンリストで、現在のマップの出力にリンクする出力を持つマップファイルを選択します。

   マップ ファイルを選択すると、マップの UUID が [ 親マップ UUID] 列に表示されます。 選択したマップに関連付けられている出力プリセットが、親マップのプリセット リストに表示されます。

1. **親マップのプリセット** ドロップダウンリストで、現在のマップの出力をリンクする出力プリセットを選択します。

1. すべての依存トピックに対して必要なマップとその出力プリセットを選択して、「**完了**」をクリックします。

   これで、依存トピックのコンテキストが設定されました。 現在のマップの出力を生成できます。 出力の生成について詳しくは、[ マップコンソールからの DITA マップの出力の生成 ](generate-output-for-a-dita-map.md#) を参照してください。

### 混合型公開

AEM Guidesは、既存のAEM サイト内での DITA コンテンツの公開をサポートしています。 例えば、既存のサイトがある場合、AEM Sites出力を使用して、そのサイトの DITA コンテンツのみを公開できます。 このプロセスでは、既存の非 DITA コンテンツはパブリッシュプロセスによって変更されません。 DITA コンテンツのみを公開するためのサイトの設定については、公開管理者に問い合わせてください。

### 公開 `conref`

コンテンツで `conref` を使用している場合は、ソース \（または参照\） トピックのコンテンツと共に、通常のコンテンツまたは埋め込みコンテンツとして公開されます。 `conref` のコンテンツがメインコンテンツと共にレンダリングされ、同じものに対して別のサイトページは作成されません。 `conref` で参照されているコンテンツを検索すると、`conref` のコンテンツを含むメイントピックまたはページのみが検索結果に表示されます。

>[!NOTE]
>
>AEM Guides バージョン 3.5 以前を使用して、`conref` コンテンツ用に個別のページを生成した場合は、「[ 孤立したサイトページを削除 ](#delete-orphan-page-aem-site)」オプションを使用して、それらのページをクリーンアップまたは削除することをお勧めします。


### コンテンツ内の文字列の検索

AEM Sites出力で文字列を検索できます。 デフォルトでは、タイトルのみで文字列を検索できます。 AEM Sites出力の内容または本文で文字列を検索するには、システム管理者に連絡して、flattening.enabled プロパティを有効にします。

![AEM Sites検索出力 ](images/aem-output-search.png){width="650" align="left"}

詳しくは、『Adobe Experience Manager Guidesのインストールと設定ガイド』の *AEM Site ノード構造のフラット化を設定する* 節を参照してください。

**親トピック：**[ 出力プリセットについて ](generate-output-understand-presets.md)
